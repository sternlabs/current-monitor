EESchema Schematic File Version 2
LIBS:k22f-64lqfp
LIBS:MKL26ZxxVFM4
LIBS:fuse
LIBS:schottky
LIBS:max6070
LIBS:ltc3260
LIBS:lm27313
LIBS:lt6106
LIBS:-vs
LIBS:+vs
LIBS:+3v
LIBS:-15v
LIBS:+15v
LIBS:com
LIBS:sip32401a
LIBS:pnp
LIBS:phone-3
LIBS:npn
LIBS:esp-12
LIBS:conn-8
LIBS:conn-7
LIBS:conn-6
LIBS:conn-5
LIBS:conn-3
LIBS:bat
LIBS:aat1217
LIBS:jumper
LIBS:pmos
LIBS:pot
LIBS:buck-sot23-5
LIBS:tp4056
LIBS:xtal
LIBS:vutmi
LIBS:vpll
LIBS:vout
LIBS:vio
LIBS:vin
LIBS:vcore
LIBS:vbu
LIBS:varef
LIBS:vana
LIBS:usb334x
LIBS:usb
LIBS:ts3usb31
LIBS:tps27081a
LIBS:tpd4s012
LIBS:tlv713
LIBS:thermistor
LIBS:testpoint
LIBS:test
LIBS:tactile-4
LIBS:spiflash
LIBS:solder-jumper-nc
LIBS:sit1602
LIBS:r4
LIBS:r
LIBS:pwr
LIBS:power_flag
LIBS:nmos
LIBS:mpu6050
LIBS:mpu-6050
LIBS:mpl3115a2
LIBS:mounting-hole
LIBS:mounthole
LIBS:microsd
LIBS:mic5205
LIBS:mchck
LIBS:max9938
LIBS:mag3110
LIBS:lpddrx16
LIBS:lm3671
LIBS:led
LIBS:l
LIBS:jtag
LIBS:ip425xcz12
LIBS:ina199
LIBS:gnd
LIBS:ferrite
LIBS:drv883x
LIBS:debugheader
LIBS:d
LIBS:cp
LIBS:conn-4
LIBS:conn-2x5
LIBS:conn-2
LIBS:cm1624
LIBS:c
LIBS:ant
LIBS:USB3300
LIBS:SAM3U-144
LIBS:ICE40HX4K-144
LIBS:+5v
LIBS:+3v3
LIBS:+1v8
LIBS:+1v2
LIBS:in-amp
LIBS:op-amp
LIBS:current-monitor-cache
EELAYER 25 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 5 6
Title "High Precision Current Monitor"
Date ""
Rev "0"
Comp "sternlabs"
Comment1 "(c) 2015 Simon Schubert"
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L K22F-64LQFP U501
U 1 1 55D3F750
P 2850 4200
F 0 "U501" H 2850 4350 60  0000 L CNN
F 1 "K22F-64LQFP" H 2850 4250 60  0000 L CNN
F 2 "libs:QFP-64-10x10" H 3850 3400 40  0001 C CNN
F 3 "" H 3850 3400 40  0000 C CNN
	1    2850 4200
	1    0    0    -1  
$EndComp
$Comp
L K22F-64LQFP U501
U 2 1 55D3F7ED
P 2450 2000
F 0 "U501" H 2450 2150 60  0000 L CNN
F 1 "K22F-64LQFP" H 2450 2050 60  0000 L CNN
F 2 "libs:QFP-64-10x10" H 3450 1200 40  0001 C CNN
F 3 "" H 3450 1200 40  0000 C CNN
	2    2450 2000
	1    0    0    -1  
$EndComp
$Comp
L K22F-64LQFP U501
U 3 1 55D3F86C
P 7950 1250
F 0 "U501" H 7950 1400 60  0000 L CNN
F 1 "K22F-64LQFP" H 7950 1300 60  0000 L CNN
F 2 "libs:QFP-64-10x10" H 8950 450 40  0001 C CNN
F 3 "" H 8950 450 40  0000 C CNN
	3    7950 1250
	1    0    0    -1  
$EndComp
$Comp
L K22F-64LQFP U501
U 4 1 55D3F895
P 8500 4650
F 0 "U501" H 8500 4800 60  0000 L CNN
F 1 "K22F-64LQFP" H 8500 4700 60  0000 L CNN
F 2 "libs:QFP-64-10x10" H 9500 3850 40  0001 C CNN
F 3 "" H 9500 3850 40  0000 C CNN
	4    8500 4650
	1    0    0    -1  
$EndComp
Wire Wire Line
	8200 4750 8400 4750
Wire Wire Line
	8200 4750 8200 4700
$Comp
L +5V #PWR062
U 1 1 55D3FF75
P 8200 4700
F 0 "#PWR062" H 8210 4700 20  0001 C CNN
F 1 "+5V" H 8200 4760 40  0000 C CNN
F 2 "" H 8200 4700 60  0000 C CNN
F 3 "" H 8200 4700 60  0000 C CNN
	1    8200 4700
	1    0    0    -1  
$EndComp
Wire Wire Line
	9550 4750 9800 4750
Wire Wire Line
	9800 4750 9800 4700
$Comp
L +3V3 #PWR063
U 1 1 55D3FFAE
P 9800 4700
F 0 "#PWR063" H 9810 4700 20  0001 C CNN
F 1 "+3V3" H 9800 4760 40  0000 C CNN
F 2 "" H 9800 4700 60  0000 C CNN
F 3 "" H 9800 4700 60  0000 C CNN
	1    9800 4700
	1    0    0    -1  
$EndComp
$Comp
L +3V3 #PWR064
U 1 1 55D3FFCC
P 7150 5000
F 0 "#PWR064" H 7160 5000 20  0001 C CNN
F 1 "+3V3" H 7150 5060 40  0000 C CNN
F 2 "" H 7150 5000 60  0000 C CNN
F 3 "" H 7150 5000 60  0000 C CNN
	1    7150 5000
	1    0    0    -1  
$EndComp
Wire Wire Line
	7150 5000 7150 5050
Wire Wire Line
	7150 5050 8400 5050
Wire Wire Line
	8350 4900 8350 5250
Wire Wire Line
	8350 5150 8400 5150
Connection ~ 8350 5050
Wire Wire Line
	8350 5250 8400 5250
Connection ~ 8350 5150
$Comp
L +3.00V #PWR065
U 1 1 55D40015
P 8100 5600
F 0 "#PWR065" H 8110 5600 20  0001 C CNN
F 1 "+3.00V" H 8100 5660 40  0000 C CNN
F 2 "" H 8100 5600 60  0000 C CNN
F 3 "" H 8100 5600 60  0000 C CNN
	1    8100 5600
	1    0    0    -1  
$EndComp
Wire Wire Line
	8350 5550 8400 5550
$Comp
L COM #PWR066
U 1 1 55D4005C
P 9650 5650
F 0 "#PWR066" V 9925 5650 60  0001 C CNN
F 1 "COM" H 9810 5535 30  0001 C CNN
F 2 "" H 9805 5660 60  0000 C CNN
F 3 "" H 9805 5660 60  0000 C CNN
	1    9650 5650
	1    0    0    -1  
$EndComp
Wire Wire Line
	9550 5550 9650 5550
Wire Wire Line
	9650 5450 9650 5650
Wire Wire Line
	9550 5450 9650 5450
Connection ~ 9650 5550
$Comp
L COM #PWR067
U 1 1 55D400AF
P 9650 5300
F 0 "#PWR067" V 9925 5300 60  0001 C CNN
F 1 "COM" H 9810 5185 30  0001 C CNN
F 2 "" H 9805 5310 60  0000 C CNN
F 3 "" H 9805 5310 60  0000 C CNN
	1    9650 5300
	1    0    0    -1  
$EndComp
Wire Wire Line
	9650 5250 9550 5250
Wire Wire Line
	9650 5050 9650 5300
Wire Wire Line
	9550 5150 9650 5150
Connection ~ 9650 5250
Wire Wire Line
	9550 5050 9650 5050
Connection ~ 9650 5150
$Comp
L C C509
U 1 1 55D40127
P 9750 4750
F 0 "C509" H 9810 4685 50  0000 L CNN
F 1 "2.2u" H 9810 4615 50  0000 L CNN
F 2 "libs:SMD-2012" H 9650 4900 60  0001 C CNN
F 3 "" H 9650 4900 60  0000 C CNN
	1    9750 4750
	1    0    0    -1  
$EndComp
$Comp
L COM #PWR068
U 1 1 55D4015F
P 9750 4950
F 0 "#PWR068" V 10025 4950 60  0001 C CNN
F 1 "COM" H 9910 4835 30  0001 C CNN
F 2 "" H 9905 4960 60  0000 C CNN
F 3 "" H 9905 4960 60  0000 C CNN
	1    9750 4950
	1    0    0    -1  
$EndComp
Connection ~ 9750 4750
$Comp
L C C506
U 1 1 55D4018F
P 8050 5050
F 0 "C506" H 8110 4985 50  0000 L CNN
F 1 "0.1u" H 8110 4915 50  0000 L CNN
F 2 "libs:SMD-1608" H 7950 5200 60  0001 C CNN
F 3 "" H 7950 5200 60  0000 C CNN
	1    8050 5050
	-1   0    0    -1  
$EndComp
$Comp
L C C505
U 1 1 55D401FB
P 7750 5050
F 0 "C505" H 7810 4985 50  0000 L CNN
F 1 "0.1u" H 7810 4915 50  0000 L CNN
F 2 "libs:SMD-1608" H 7650 5200 60  0001 C CNN
F 3 "" H 7650 5200 60  0000 C CNN
	1    7750 5050
	-1   0    0    -1  
$EndComp
$Comp
L C C503
U 1 1 55D40232
P 7450 5050
F 0 "C503" H 7510 4985 50  0000 L CNN
F 1 "0.1u" H 7510 4915 50  0000 L CNN
F 2 "libs:SMD-1608" H 7350 5200 60  0001 C CNN
F 3 "" H 7350 5200 60  0000 C CNN
	1    7450 5050
	-1   0    0    -1  
$EndComp
Connection ~ 8050 5050
Connection ~ 7750 5050
Connection ~ 7450 5050
$Comp
L COM #PWR069
U 1 1 55D4028A
P 7150 5300
F 0 "#PWR069" V 7425 5300 60  0001 C CNN
F 1 "COM" H 7310 5185 30  0001 C CNN
F 2 "" H 7305 5310 60  0000 C CNN
F 3 "" H 7305 5310 60  0000 C CNN
	1    7150 5300
	1    0    0    -1  
$EndComp
Connection ~ 8050 5250
Connection ~ 7750 5250
Connection ~ 7450 5250
Wire Wire Line
	7150 5250 8050 5250
Wire Wire Line
	7150 5250 7150 5300
Wire Wire Line
	8350 4900 8400 4900
$Comp
L C C508
U 1 1 55D40539
P 8200 4750
F 0 "C508" H 8260 4685 50  0000 L CNN
F 1 "2.2u" H 8260 4615 50  0000 L CNN
F 2 "libs:SMD-2012" H 8100 4900 60  0001 C CNN
F 3 "" H 8100 4900 60  0000 C CNN
	1    8200 4750
	-1   0    0    -1  
$EndComp
$Comp
L COM #PWR070
U 1 1 55D405ED
P 8200 4950
F 0 "#PWR070" V 8475 4950 60  0001 C CNN
F 1 "COM" H 8360 4835 30  0001 C CNN
F 2 "" H 8355 4960 60  0000 C CNN
F 3 "" H 8355 4960 60  0000 C CNN
	1    8200 4950
	1    0    0    -1  
$EndComp
$Comp
L JTAG J501
U 1 1 55D40683
P 8700 3150
F 0 "J501" H 8300 2800 50  0000 L CNN
F 1 "JTAG" H 9100 2800 50  0000 R CNN
F 2 "libs:CONN-2x5-1.27-SMT" H 8600 2950 50  0001 C CNN
F 3 "" H 8600 2950 50  0000 C CNN
	1    8700 3150
	1    0    0    -1  
$EndComp
Text HLabel 2250 2400 0    60   Input ~ 0
SENSE_COARSE
Text HLabel 2250 2300 0    60   Input ~ 0
SENSE_FINE
Text HLabel 2250 2100 0    60   Input ~ 0
SENSE_VOLTAGE
Wire Wire Line
	2250 2300 2350 2300
Wire Wire Line
	2350 2400 2250 2400
Wire Wire Line
	2250 2100 2350 2100
Text HLabel 4150 2100 2    60   Output ~ 0
REF_ADJUST
Wire Wire Line
	4150 2100 4000 2100
$Comp
L XTAL-4 Y501
U 1 1 55D40B3D
P 10000 1450
F 0 "Y501" H 10100 1475 40  0000 C CNN
F 1 "4MHz" H 10050 1400 40  0000 L CNN
F 2 "" H 10000 1450 60  0001 C CNN
F 3 "" H 10000 1450 60  0000 C CNN
	1    10000 1450
	-1   0    0    -1  
$EndComp
$Comp
L C C502
U 1 1 55D40BF3
P 10200 1550
F 0 "C502" H 10260 1485 50  0000 L CNN
F 1 "C" H 10260 1415 50  0000 L CNN
F 2 "libs:SMD-1608" H 10100 1700 60  0001 C CNN
F 3 "" H 10100 1700 60  0000 C CNN
	1    10200 1550
	0    -1   1    0   
$EndComp
$Comp
L C C501
U 1 1 55D40C62
P 10200 1350
F 0 "C501" H 10260 1285 50  0000 L CNN
F 1 "C" H 10260 1215 50  0000 L CNN
F 2 "libs:SMD-1608" H 10100 1500 60  0001 C CNN
F 3 "" H 10100 1500 60  0000 C CNN
	1    10200 1350
	0    -1   -1   0   
$EndComp
Wire Wire Line
	9600 1350 10200 1350
Connection ~ 10000 1350
Wire Wire Line
	9600 1550 10200 1550
Connection ~ 10000 1550
Wire Wire Line
	10400 1450 10450 1450
Wire Wire Line
	10400 1350 10400 1550
Connection ~ 10400 1450
$Comp
L COM #PWR071
U 1 1 55D40EA2
P 10450 1450
F 0 "#PWR071" V 10725 1450 60  0001 C CNN
F 1 "COM" H 10610 1335 30  0001 C CNN
F 2 "" H 10605 1460 60  0000 C CNN
F 3 "" H 10605 1460 60  0000 C CNN
	1    10450 1450
	0    -1   -1   0   
$EndComp
NoConn ~ 9600 1850
NoConn ~ 9600 2050
Text HLabel 7700 1350 0    60   Input ~ 0
USB_DP
Text HLabel 7700 1450 0    60   Input ~ 0
USB_DM
Wire Wire Line
	7700 1450 7850 1450
Wire Wire Line
	7850 1350 7700 1350
Wire Wire Line
	6650 1650 7850 1650
Text Label 7400 1650 0    50   ~ 0
~RESET
Wire Wire Line
	7850 1750 7400 1750
Text Label 7400 1750 0    50   ~ 0
SWD_CLK
Wire Wire Line
	7850 1850 7400 1850
Text Label 7400 1850 0    50   ~ 0
UART_RX
Wire Wire Line
	7850 1950 7400 1950
Text Label 7400 1950 0    50   ~ 0
UART_TX
Wire Wire Line
	7850 2050 7400 2050
Text Label 7400 2050 0    50   ~ 0
SWD_DIO
Wire Wire Line
	9750 3350 9300 3350
Text Label 9750 3350 2    50   ~ 0
~RESET
Wire Wire Line
	9300 3050 9750 3050
Text Label 9750 3050 2    50   ~ 0
SWD_CLK
Wire Wire Line
	9300 3250 9750 3250
Text Label 9750 3250 2    50   ~ 0
UART_RX
Wire Wire Line
	9300 3150 9750 3150
Text Label 9750 3150 2    50   ~ 0
UART_TX
Wire Wire Line
	9300 2950 9750 2950
Text Label 9750 2950 2    50   ~ 0
SWD_DIO
$Comp
L +3V3 #PWR072
U 1 1 55D415D9
P 8000 2900
F 0 "#PWR072" H 8010 2900 20  0001 C CNN
F 1 "+3V3" H 8000 2960 40  0000 C CNN
F 2 "" H 8000 2900 60  0000 C CNN
F 3 "" H 8000 2900 60  0000 C CNN
	1    8000 2900
	1    0    0    -1  
$EndComp
Wire Wire Line
	8000 2900 8000 2950
Wire Wire Line
	8000 2950 8100 2950
$Comp
L COM #PWR073
U 1 1 55D41653
P 8000 3450
F 0 "#PWR073" V 8275 3450 60  0001 C CNN
F 1 "COM" H 8160 3335 30  0001 C CNN
F 2 "" H 8155 3460 60  0000 C CNN
F 3 "" H 8155 3460 60  0000 C CNN
	1    8000 3450
	1    0    0    -1  
$EndComp
Wire Wire Line
	8100 3050 8000 3050
Wire Wire Line
	8000 3050 8000 3450
Wire Wire Line
	8100 3150 8000 3150
Connection ~ 8000 3150
NoConn ~ 8100 3350
$Comp
L +3V3 #PWR074
U 1 1 55D41AA6
P 7300 5400
F 0 "#PWR074" H 7310 5400 20  0001 C CNN
F 1 "+3V3" H 7300 5460 40  0000 C CNN
F 2 "" H 7300 5400 60  0000 C CNN
F 3 "" H 7300 5400 60  0000 C CNN
	1    7300 5400
	1    0    0    -1  
$EndComp
$Comp
L C C504
U 1 1 55D41AD8
P 7700 5450
F 0 "C504" H 7760 5385 50  0000 L CNN
F 1 "0.1u" H 7760 5315 50  0000 L CNN
F 2 "libs:SMD-1608" H 7600 5600 60  0001 C CNN
F 3 "" H 7600 5600 60  0000 C CNN
	1    7700 5450
	1    0    0    -1  
$EndComp
Wire Wire Line
	7550 5450 8400 5450
Wire Wire Line
	7300 5450 7300 5400
Connection ~ 7700 5450
$Comp
L FERRITE FB501
U 1 1 55D41BFB
P 7450 5450
F 0 "FB501" H 7375 5375 40  0000 L CNN
F 1 "FERRITE" H 7375 5300 40  0000 L CNN
F 2 "libs:SMD-1608" H 7450 5350 60  0001 C CNN
F 3 "" H 7450 5350 60  0000 C CNN
	1    7450 5450
	1    0    0    -1  
$EndComp
Wire Wire Line
	7350 5450 7300 5450
$Comp
L COM #PWR075
U 1 1 55D41D69
P 7700 5650
F 0 "#PWR075" V 7975 5650 60  0001 C CNN
F 1 "COM" H 7860 5535 30  0001 C CNN
F 2 "" H 7855 5660 60  0000 C CNN
F 3 "" H 7855 5660 60  0000 C CNN
	1    7700 5650
	1    0    0    -1  
$EndComp
$Comp
L C C507
U 1 1 55D41F21
P 8100 5650
F 0 "C507" H 8160 5585 50  0000 L CNN
F 1 "0.1u" H 8160 5515 50  0000 L CNN
F 2 "libs:SMD-1608" H 8000 5800 60  0001 C CNN
F 3 "" H 8000 5800 60  0000 C CNN
	1    8100 5650
	1    0    0    -1  
$EndComp
$Comp
L COM #PWR076
U 1 1 55D41F27
P 8100 5850
F 0 "#PWR076" V 8375 5850 60  0001 C CNN
F 1 "COM" H 8260 5735 30  0001 C CNN
F 2 "" H 8255 5860 60  0000 C CNN
F 3 "" H 8255 5860 60  0000 C CNN
	1    8100 5850
	1    0    0    -1  
$EndComp
Wire Wire Line
	8100 5650 8350 5650
Wire Wire Line
	8350 5650 8350 5550
Wire Wire Line
	8100 5600 8100 5650
NoConn ~ 10100 1400
NoConn ~ 10100 1500
NoConn ~ 2350 2500
NoConn ~ 2750 4600
NoConn ~ 2750 4700
NoConn ~ 2750 4800
NoConn ~ 2750 4900
NoConn ~ 2750 5000
NoConn ~ 2750 5100
NoConn ~ 2750 5200
NoConn ~ 2750 5300
NoConn ~ 2750 5500
NoConn ~ 2750 5600
NoConn ~ 2750 5700
NoConn ~ 2750 5800
NoConn ~ 2750 5900
NoConn ~ 2750 6000
NoConn ~ 2750 6100
NoConn ~ 2750 6200
NoConn ~ 3700 6200
NoConn ~ 3700 6100
NoConn ~ 3700 5900
NoConn ~ 3700 5800
NoConn ~ 3700 5700
NoConn ~ 3700 5600
NoConn ~ 3700 5500
NoConn ~ 3700 5400
NoConn ~ 3700 5300
NoConn ~ 3700 5200
NoConn ~ 3700 5100
NoConn ~ 3700 5000
NoConn ~ 3700 4900
NoConn ~ 3700 4800
NoConn ~ 3700 4500
NoConn ~ 3700 4400
NoConn ~ 3700 4300
$Comp
L POWER_FLAG #PWR077
U 1 1 55D46E67
P 8250 5450
F 0 "#PWR077" H 8250 5450 50  0001 C CNN
F 1 "POWER_FLAG" H 8250 5575 30  0000 C CNN
F 2 "" H 8250 5450 50  0000 C CNN
F 3 "" H 8250 5450 50  0000 C CNN
	1    8250 5450
	1    0    0    -1  
$EndComp
Connection ~ 8250 5450
$Comp
L TACTILE-4 S501
U 1 1 55D4C1DB
P 6450 1750
F 0 "S501" H 6300 1650 60  0000 L CNN
F 1 "RESET" H 6450 2000 60  0000 C CNN
F 2 "libs:TACT-4632" H 6450 1750 60  0001 C CNN
F 3 "" H 6450 1750 60  0000 C CNN
	1    6450 1750
	1    0    0    -1  
$EndComp
NoConn ~ 6650 1750
$Comp
L R R501
U 1 1 55D4C4CC
P 6950 1350
F 0 "R501" H 7010 1230 50  0000 L CNN
F 1 "10k" H 7010 1160 50  0000 L CNN
F 2 "libs:SMD-1608" H 7085 1190 60  0001 C CNN
F 3 "" H 7085 1190 60  0000 C CNN
	1    6950 1350
	-1   0    0    -1  
$EndComp
Connection ~ 6950 1650
$Comp
L +3V3 #PWR078
U 1 1 55D4C52B
P 6950 1350
F 0 "#PWR078" H 6960 1350 20  0001 C CNN
F 1 "+3V3" H 6950 1410 40  0000 C CNN
F 2 "" H 6950 1350 60  0000 C CNN
F 3 "" H 6950 1350 60  0000 C CNN
	1    6950 1350
	1    0    0    -1  
$EndComp
$Comp
L C C510
U 1 1 55D4C5E6
P 7100 1700
F 0 "C510" H 7160 1635 50  0000 L CNN
F 1 "0.1u" H 7160 1565 50  0000 L CNN
F 2 "libs:SMD-1608" H 7000 1850 60  0001 C CNN
F 3 "" H 7000 1850 60  0000 C CNN
	1    7100 1700
	-1   0    0    -1  
$EndComp
$Comp
L COM #PWR079
U 1 1 55D4C625
P 7100 1900
F 0 "#PWR079" V 7375 1900 60  0001 C CNN
F 1 "COM" H 7260 1785 30  0001 C CNN
F 2 "" H 7255 1910 60  0000 C CNN
F 3 "" H 7255 1910 60  0000 C CNN
	1    7100 1900
	1    0    0    -1  
$EndComp
Wire Wire Line
	7100 1700 7100 1650
Connection ~ 7100 1650
$Comp
L COM #PWR080
U 1 1 55D4C6F6
P 6100 1900
F 0 "#PWR080" V 6375 1900 60  0001 C CNN
F 1 "COM" H 6260 1785 30  0001 C CNN
F 2 "" H 6255 1910 60  0000 C CNN
F 3 "" H 6255 1910 60  0000 C CNN
	1    6100 1900
	1    0    0    -1  
$EndComp
Wire Wire Line
	6250 1650 6100 1650
Wire Wire Line
	6100 1650 6100 1900
NoConn ~ 6250 1750
Wire Wire Line
	3700 4600 3850 4600
Text HLabel 3850 4600 2    60   Output ~ 0
VS_ENABLE
Text Notes 1700 3350 0    60   ~ 0
XXX limit sense voltages with schottkys BAS40-04
NoConn ~ 2350 2200
$EndSCHEMATC
